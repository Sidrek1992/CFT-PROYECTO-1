import{c as Be,r as d,j as e,C as Ye,a as he,S as Oe,b as fe,d as se,g as He,e as oe,R as Xe,U as de,F as qe,T as ae,P as re,X as Ge,f as Ke,D as Ve,h as ce,i as xe,k as Je,l as Ze,m as ue,n as We,E as Qe,o as et,p as tt,q as st,_ as pe,s as at}from"./index-CxovqTKt.js";import{U as me}from"./upload-CUc9Fh0e.js";import{T as rt}from"./trending-down-GxuaOiB8.js";import"./vendor--Eh9ivFN.js";import"./genai-IPx1z701.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],be=Be("pen-line",lt),ge='button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';let U=0,le=null;const nt=({isActive:D,onEscape:k,restoreFocus:p=!0,initialFocus:g})=>{const h=d.useRef(null),y=d.useRef(null);d.useEffect(()=>{if(D){y.current=document.activeElement,U===0&&(le=document.body.style.overflow,document.body.style.overflow="hidden"),U+=1;const m=setTimeout(()=>{if(!h.current)return;let x=null;x=h.current.querySelector(g),x||(x=h.current.querySelector(ge)),x==null||x.focus()},50);return()=>{clearTimeout(m),U=Math.max(0,U-1),U===0&&le!==null&&(document.body.style.overflow=le),p&&y.current&&y.current.focus()}}},[D,g,p]);const n=d.useCallback(r=>{if(!(!D||!h.current)){if(r.key==="Escape"&&k){r.preventDefault(),r.stopPropagation(),k();return}if(r.key==="Tab"){const m=h.current.querySelectorAll(ge);if(m.length===0){r.preventDefault();return}const x=m[0],P=m[m.length-1],F=document.activeElement;r.shiftKey?(F===x||!h.current.contains(F))&&(r.preventDefault(),P.focus()):(F===P||!h.current.contains(F))&&(r.preventDefault(),x.focus())}}},[D,k]);return{containerRef:h,handleKeyDown:n}},it=({records:D,year:k=new Date().getFullYear()})=>{const p=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],g=d.useMemo(()=>D.filter(n=>n.fechaInicio?new Date(n.fechaInicio+"T12:00:00").getFullYear()===k:!1).sort((n,r)=>new Date(n.fechaInicio).getTime()-new Date(r.fechaInicio).getTime()),[D,k]),h=d.useMemo(()=>{const n=[];for(let r=0;r<12;r++){const m=g.filter(x=>new Date(x.fechaInicio+"T12:00:00").getMonth()===r);n.push({month:r,records:m})}return n},[g]),y=d.useMemo(()=>g.reduce((n,r)=>(r.solicitudType==="PA"?n.pa+=r.cantidadDias:n.fl+=r.cantidadDias,n),{pa:0,fl:0}),[g]);return g.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-400 dark:text-slate-500",children:[e.jsx(Ye,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsxs("p",{className:"text-xs font-bold",children:["Sin permisos registrados en ",k]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("h4",{className:"text-xs font-black text-slate-700 dark:text-slate-300 uppercase tracking-wider",children:["LÃ­nea de Tiempo ",k]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-bold",children:[e.jsxs("span",{className:"flex items-center gap-1 text-indigo-600 dark:text-indigo-400",children:[e.jsx(he,{size:10})," PA: ",y.pa,"d"]}),e.jsxs("span",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[e.jsx(Oe,{size:10})," FL: ",y.fl,"d"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-0 right-0 h-0.5 bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"flex justify-between relative",children:h.map(({month:n,records:r})=>{const m=r.length>0,x=r.reduce((v,S)=>v+S.cantidadDias,0),P=r.some(v=>v.solicitudType==="PA"),F=r.some(v=>v.solicitudType==="FL");return e.jsxs("div",{className:"flex flex-col items-center relative group",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black transition-all cursor-pointer ${m?P&&F?"bg-gradient-to-br from-indigo-500 to-amber-500 text-white shadow-lg":P?"bg-indigo-500 text-white shadow-md":"bg-amber-500 text-white shadow-md":"bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-500"}`,children:m?x:p[n]}),e.jsx("span",{className:`mt-1 text-[8px] font-bold uppercase ${m?"text-slate-700 dark:text-slate-300":"text-slate-400 dark:text-slate-600"}`,children:p[n]}),m&&e.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none",children:[e.jsx("div",{className:"bg-slate-900 text-white text-[9px] px-3 py-2 rounded-lg shadow-xl whitespace-nowrap",children:r.map((v,S)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${v.solicitudType==="PA"?"bg-indigo-400":"bg-amber-400"}`}),e.jsxs("span",{children:[v.solicitudType,": ",v.cantidadDias,"d"]}),e.jsxs("span",{className:"text-slate-400",children:[new Date(v.fechaInicio+"T12:00:00").getDate(),"/",n+1]})]},S))}),e.jsx("div",{className:"w-2 h-2 bg-slate-900 rotate-45 absolute -top-1 left-1/2 -translate-x-1/2"})]})]},n)})})]}),e.jsx("div",{className:"mt-4 space-y-1 max-h-32 overflow-y-auto",children:g.map((n,r)=>{const m=new Date(n.fechaInicio+"T12:00:00");return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] ${n.solicitudType==="PA"?"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300":"bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300"}`,children:[e.jsx("span",{className:"font-black",children:n.solicitudType}),e.jsx(fe,{size:10,className:"opacity-40"}),e.jsx("span",{className:"font-mono",children:m.toLocaleDateString("es-CL")}),e.jsxs("span",{className:"font-bold",children:[n.cantidadDias,"d"]}),e.jsx("span",{className:"text-slate-400 dark:text-slate-500 truncate flex-1",children:n.tipoJornada})]},r)})})]})},B=st.create("EmployeeModal"),K=20,pt=({isOpen:D,onClose:k,employees:p,records:g,onAddEmployee:h,onUpdateEmployee:y,onDeleteEmployee:n,onFilterByEmployee:r,onQuickDecree:m})=>{const[x,P]=d.useState(""),[F,v]=d.useState("nombre"),[S,ke]=d.useState("asc"),[M,je]=d.useState("all"),[E,Ne]=d.useState("all"),[ve,we]=d.useState(null),[ye,V]=d.useState(!1),[L,Y]=d.useState({nombre:"",rut:""}),[De,J]=d.useState(null),[Fe,Z]=d.useState(null),[C,R]=d.useState({nombre:"",rut:""}),[I,W]=d.useState(1),[Ce,O]=d.useState(!1),[T,Q]=d.useState([]),H=d.useRef(null),A=d.useMemo(()=>{const t={};return p.forEach(i=>{const s=g.filter(c=>c.rut===i.rut||c.funcionario.toLowerCase()===i.nombre.toLowerCase()),o=s.filter(c=>c.solicitudType==="PA").reduce((c,w)=>c+w.cantidadDias,0),u=s.filter(c=>c.solicitudType==="FL").reduce((c,w)=>c+w.cantidadDias,0),l=[...s].sort((c,w)=>se(c,w,"fechaInicio")),a=s.filter(c=>c.solicitudType==="PA").sort((c,w)=>se(c,w))[0],b=a?a.diasHaber:6,f=a?a.diasHaber-a.cantidadDias:6,N=s.filter(c=>c.solicitudType==="FL").sort((c,w)=>se(c,w))[0],q=N?He(N,0):0;t[i.rut]={totalDecrees:s.length,diasPA:o,diasFL:u,diasHaber:b,saldo:f,saldoFL:q,lastDecree:l[0]||null,decrees:l}}),t},[p,g]),_=d.useMemo(()=>{const t=g.length,i=g.filter(l=>l.solicitudType==="PA").reduce((l,a)=>l+a.cantidadDias,0),s=g.filter(l=>l.solicitudType==="FL").reduce((l,a)=>l+a.cantidadDias,0),o=p.length>0?(t/p.length).toFixed(1):"0",u=Object.values(A).filter(l=>l.saldo<2).length;return{totalDecrees:t,totalDiasPA:i,totalDiasFL:s,avgPerEmployee:o,lowBalanceCount:u}},[g,p,A]),z=d.useMemo(()=>{const t=new Date,i=t.getMonth(),s=t.getFullYear(),o=new Date(t.getFullYear(),t.getMonth()-3,t.getDate()).getTime();return p.filter(u=>{if(!(u.nombre.toLowerCase().includes(x.toLowerCase())||u.rut.includes(x)))return!1;const a=A[u.rut];if(!a)return M==="all"&&E==="all";if(M==="high"&&a.saldo<4||M==="medium"&&(a.saldo<2||a.saldo>=4)||M==="low"&&a.saldo>=2)return!1;if(E!=="all"){const b=a.lastDecree?new Date(a.lastDecree.fechaInicio+"T12:00:00"):null;if(E==="thisMonth"){if(!b||b.getMonth()!==i||b.getFullYear()!==s)return!1}else if(E==="thisYear"){if(!b||b.getFullYear()!==s)return!1}else if(E==="noRecent"){const f=a.lastDecree?oe(a.lastDecree,"fechaInicio"):null;if(f&&f>o)return!1}}return!0}).sort((u,l)=>{const a=A[u.rut]||{totalDecrees:0,diasPA:0,diasFL:0,saldo:6},b=A[l.rut]||{totalDecrees:0,diasPA:0,diasFL:0,saldo:6};let f,N;switch(F){case"nombre":f=u.nombre.toLowerCase(),N=l.nombre.toLowerCase();break;case"totalDecrees":f=a.totalDecrees,N=b.totalDecrees;break;case"diasPA":f=a.diasPA,N=b.diasPA;break;case"diasFL":f=a.diasFL,N=b.diasFL;break;case"saldo":f=a.saldo,N=b.saldo;break;default:f=u.nombre,N=l.nombre}return f<N?S==="asc"?-1:1:f>N?S==="asc"?1:-1:0})},[p,x,F,S,M,E,A]),X=Math.ceil(z.length/K),ne=d.useMemo(()=>{const t=(I-1)*K;return z.slice(t,t+K)},[z,I]);Xe.useEffect(()=>{W(1)},[x,M,E]);const{containerRef:Le,handleKeyDown:Pe}=nt({isActive:D,onEscape:k,initialFocus:"[data-autofocus]"});if(!D)return null;const ee=t=>t>=4?"text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30":t>=2?"text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/30":"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/30",Se=t=>t>=4?e.jsx(at,{size:12}):t>=2?e.jsx(rt,{size:12}):e.jsx(ae,{size:12}),Ee=()=>{if(!(!L.nombre.trim()||!L.rut.trim())&&h){if(p.some(t=>t.rut===L.rut)){alert("Ya existe un funcionario con este RUT");return}h({nombre:L.nombre.trim().toUpperCase(),rut:L.rut.trim()}),Y({nombre:"",rut:""}),V(!1)}},Te=t=>{n&&(n(t),J(null))},Ae=async()=>{try{B.info("Exportando lista de empleados...");const t=await pe(()=>import("./xlsx-CkFp8p6R.js"),[]),i=z.map(u=>{const l=A[u.rut]||{totalDecrees:0,diasPA:0,diasFL:0,saldo:6,saldoFL:0,lastDecree:null};return{Nombre:u.nombre,RUT:u.rut,"Total Decretos":l.totalDecrees,"DÃ­as PA":l.diasPA,"DÃ­as FL":l.diasFL,"Saldo PA":l.saldo,"Saldo FL":l.diasFL>0?l.saldoFL:"-","Ãšltimo Decreto":l.lastDecree?l.lastDecree.acto:"-"}}),s=t.utils.json_to_sheet(i),o=t.utils.book_new();t.utils.book_append_sheet(o,s,"Funcionarios"),t.writeFile(o,`funcionarios_${new Date().toISOString().split("T")[0]}.xlsx`),B.info("ExportaciÃ³n completada")}catch(t){B.error("Error exportando empleados:",t)}},Me=t=>{Z(t.rut),R({nombre:t.nombre,rut:t.rut})},ze=t=>{if(!(!C.nombre.trim()||!C.rut.trim())){if(C.rut!==t&&p.some(i=>i.rut===C.rut)){alert("Ya existe un funcionario con este RUT");return}y&&y(t,{nombre:C.nombre.trim().toUpperCase(),rut:C.rut.trim()}),Z(null),R({nombre:"",rut:""})}},Ie=()=>{Z(null),R({nombre:"",rut:""})},Re=async t=>{var s;const i=(s=t.target.files)==null?void 0:s[0];if(i){try{const o=await pe(()=>import("./xlsx-CkFp8p6R.js"),[]),u=new FileReader;u.onload=l=>{var w;const a=new Uint8Array((w=l.target)==null?void 0:w.result),b=o.read(a,{type:"array"}),f=b.SheetNames[0],N=b.Sheets[f],q=o.utils.sheet_to_json(N,{header:1}),c=[];for(let te=1;te<q.length;te++){const j=q[te];if(!j||j.length<2)continue;let G="",$="";typeof j[0]=="string"&&typeof j[1]=="string"&&(j[1].includes("-")||j[1].match(/^\d/)?(G=String(j[0]).trim().toUpperCase(),$=String(j[1]).trim()):j.length>=3&&(G=[j[0],j[1],j[2]].filter(Boolean).join(" ").trim().toUpperCase(),$=String(j[3]||j[2]||"").trim())),G&&$&&!p.some(Ue=>Ue.rut===$)&&c.push({nombre:G,rut:$})}Q(c),O(!0)},u.readAsArrayBuffer(i)}catch(o){B.error("Error importando archivo:",o),alert("Error al procesar el archivo. AsegÃºrese de que sea un Excel vÃ¡lido.")}H.current&&(H.current.value="")}},_e=()=>{h&&(T.forEach(t=>h(t)),Q([]),O(!1),B.info(`Importados ${T.length} funcionarios`))},ie=t=>{if(t.totalDecrees===0)return 0;const i=t.decrees[t.decrees.length-1];if(!i)return 0;const s=oe(i,"fechaInicio");if(!s)return 0;const o=Math.max(1,(Date.now()-s)/(1e3*60*60*24*30));return t.diasPA/o},$e=t=>{const i=ie(t);if(i<=0)return null;const s=t.saldo/i;if(s>12)return null;const o=new Date;return o.setMonth(o.getMonth()+Math.floor(s)),o};return e.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4",onClick:k,role:"dialog","aria-modal":"true","aria-labelledby":"employee-modal-title",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm"}),e.jsxs("div",{ref:Le,onKeyDown:Pe,className:"relative w-full max-w-4xl max-h-[90vh] bg-white dark:bg-slate-800 rounded-3xl shadow-2xl overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-900 via-slate-800 to-indigo-900 dark:from-slate-950 dark:via-slate-900 dark:to-indigo-950 px-4 sm:px-6 py-3 text-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:e.jsx(de,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{id:"employee-modal-title",className:"text-sm sm:text-base font-extrabold uppercase tracking-tight",children:"GestiÃ³n de Personal"}),e.jsxs("p",{className:"text-[9px] font-bold uppercase opacity-60 tracking-wider",children:[p.length," funcionarios"]})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white/10 rounded-lg",children:[e.jsx(qe,{size:10,className:"opacity-60"}),e.jsx("span",{className:"text-xs font-black",children:_.totalDecrees})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-indigo-500/30 rounded-lg",children:[e.jsx("span",{className:"text-[9px] font-bold opacity-70",children:"PA"}),e.jsx("span",{className:"text-xs font-black text-indigo-300",children:_.totalDiasPA})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-amber-500/30 rounded-lg",children:[e.jsx("span",{className:"text-[9px] font-bold opacity-70",children:"FL"}),e.jsx("span",{className:"text-xs font-black text-amber-300",children:_.totalDiasFL})]}),_.lowBalanceCount>0&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-red-500/30 rounded-lg",children:[e.jsx(ae,{size:10,className:"text-red-300"}),e.jsx("span",{className:"text-xs font-black text-red-300",children:_.lowBalanceCount})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all",children:[e.jsx(re,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"AÃ±adir"})]}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-white/20 rounded-lg transition-all",children:e.jsx(Ge,{className:"w-4 h-4"})})]})]})}),e.jsx("div",{className:"px-4 py-3 border-b border-slate-100 dark:border-slate-700 flex-shrink-0",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[e.jsx(Ke,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{placeholder:"Buscar por nombre o RUT...",className:"w-full pl-9 pr-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg outline-none focus:ring-2 focus:ring-indigo-100 dark:focus:ring-indigo-900/50 focus:border-indigo-300 dark:focus:border-indigo-600 font-bold text-[11px] uppercase tracking-wide text-slate-700 dark:text-slate-200 placeholder:text-slate-300 dark:placeholder:text-slate-500",value:x,onChange:t=>P(t.target.value),autoFocus:!0})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-600 hidden sm:block"}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-700 rounded-lg p-0.5 gap-0.5",children:[{key:"all",label:"Todos"},{key:"high",label:"â—",color:"text-emerald-500",title:"Alto"},{key:"medium",label:"â—",color:"text-amber-500",title:"Medio"},{key:"low",label:"â—",color:"text-red-500",title:"Bajo"}].map(t=>e.jsx("button",{onClick:()=>je(t.key),title:t.title||t.label,className:`px-2 py-1 rounded text-[10px] font-black transition-all ${M===t.key?"bg-white dark:bg-slate-600 shadow-sm "+(t.color||"text-slate-700 dark:text-white"):(t.color||"text-slate-400")+" hover:opacity-80"}`,children:t.label},t.key))}),e.jsxs("select",{value:E,onChange:t=>Ne(t.target.value),className:"px-2 py-1.5 bg-slate-100 dark:bg-slate-700 border-0 rounded-lg text-[10px] font-bold text-slate-600 dark:text-slate-300 outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"ðŸ“… Todos"}),e.jsx("option",{value:"thisMonth",children:"Este Mes"}),e.jsx("option",{value:"thisYear",children:"Este AÃ±o"}),e.jsx("option",{value:"noRecent",children:"Sin Actividad"})]}),e.jsxs("select",{value:`${F}-${S}`,onChange:t=>{const[i,s]=t.target.value.split("-");v(i),ke(s)},className:"px-2 py-1.5 bg-slate-100 dark:bg-slate-700 border-0 rounded-lg text-[10px] font-bold text-slate-600 dark:text-slate-300 outline-none cursor-pointer",children:[e.jsx("option",{value:"nombre-asc",children:"A-Z"}),e.jsx("option",{value:"nombre-desc",children:"Z-A"}),e.jsx("option",{value:"totalDecrees-desc",children:"+ Decretos"}),e.jsx("option",{value:"saldo-asc",children:"- Saldo"}),e.jsx("option",{value:"saldo-desc",children:"+ Saldo"})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx("button",{onClick:Ae,className:"p-2 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-lg hover:bg-emerald-100 dark:hover:bg-emerald-900/50 transition-all",title:"Exportar a Excel",children:e.jsx(Ve,{size:14})}),e.jsx("input",{type:"file",ref:H,onChange:Re,accept:".xlsx,.xls,.csv",className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=H.current)==null?void 0:t.click()},className:"p-2 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-all",title:"Importar desde Excel",children:e.jsx(me,{size:14})})]})]})}),ye&&e.jsx("div",{className:"px-4 py-2 bg-emerald-50 dark:bg-emerald-900/20 border-b border-emerald-100 dark:border-emerald-800 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{size:14,className:"text-emerald-600 flex-shrink-0"}),e.jsx("input",{placeholder:"Nombre completo",value:L.nombre,onChange:t=>Y({...L,nombre:t.target.value}),className:"flex-1 px-3 py-1.5 bg-white dark:bg-slate-700 border border-emerald-200 dark:border-emerald-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-200 dark:focus:ring-emerald-800 text-[11px] font-bold uppercase tracking-wide text-slate-700 dark:text-slate-200 placeholder:text-slate-300"}),e.jsx("input",{placeholder:"RUT",value:L.rut,onChange:t=>Y({...L,rut:t.target.value}),className:"w-36 px-3 py-1.5 bg-white dark:bg-slate-700 border border-emerald-200 dark:border-emerald-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-200 dark:focus:ring-emerald-800 text-[11px] font-bold tracking-wide text-slate-700 dark:text-slate-200 placeholder:text-slate-300 font-mono"}),e.jsxs("button",{onClick:Ee,className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-[10px] font-black uppercase transition-all flex items-center gap-1",children:[e.jsx(ce,{size:12})," Guardar"]}),e.jsx("button",{onClick:()=>{V(!1),Y({nombre:"",rut:""})},className:"p-1.5 bg-slate-200 dark:bg-slate-600 text-slate-500 dark:text-slate-400 rounded-lg hover:bg-slate-300 transition-all",children:e.jsx(xe,{size:14})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-4 py-2",children:e.jsxs("div",{className:"grid gap-1",children:[ne.map((t,i)=>{const s=A[t.rut]||{totalDecrees:0,diasPA:0,diasFL:0,saldo:6,saldoFL:0,diasHaber:6,lastDecree:null,decrees:[]},o=ve===t.rut,u=Fe===t.rut,l=(I-1)*K+i;return e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-all cursor-pointer ${o?"bg-indigo-50 dark:bg-indigo-900/30 ring-1 ring-indigo-200 dark:ring-indigo-700":"bg-slate-50 dark:bg-slate-700/50 hover:bg-indigo-50 dark:hover:bg-indigo-900/20"}`,onClick:()=>we(o?null:t.rut),children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center transition-all ${o?"bg-indigo-600 text-white":"bg-white dark:bg-slate-600 text-slate-300 dark:text-slate-400 group-hover:text-indigo-500"}`,children:e.jsx(Je,{size:18})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-[11px] font-black uppercase tracking-tight truncate ${o?"text-indigo-700 dark:text-indigo-300":"text-slate-800 dark:text-white"}`,children:t.nombre}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 dark:text-slate-500 font-mono",children:t.rut})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 text-[9px] font-bold",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-600 rounded text-slate-500 dark:text-slate-300",children:s.totalDecrees}),e.jsxs("span",{className:"px-1.5 py-0.5 bg-indigo-50 dark:bg-indigo-900/40 rounded text-indigo-600 dark:text-indigo-400",children:["PA:",s.diasPA]}),e.jsxs("span",{className:"px-1.5 py-0.5 bg-amber-50 dark:bg-amber-900/40 rounded text-amber-600 dark:text-amber-400",children:["FL:",s.diasFL]})]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-[10px] font-black ${ee(s.saldo)}`,children:[Se(s.saldo),e.jsx("span",{children:s.saldo.toFixed(1)})]}),e.jsxs("span",{className:"text-[8px] font-bold text-slate-300 dark:text-slate-600 w-6 text-right",children:["#",(l+1).toString().padStart(2,"0")]}),e.jsx(Ze,{size:14,className:`text-slate-400 transition-transform ${o?"rotate-180":""}`})]}),o&&e.jsxs("div",{className:"mt-2 ml-4 sm:ml-16 p-4 bg-white dark:bg-slate-700 rounded-xl border border-slate-200 dark:border-slate-600 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-600 rounded-lg p-3",children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Total Decretos"}),e.jsx("p",{className:"text-lg font-black text-slate-700 dark:text-white",children:s.totalDecrees})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-[9px] font-bold text-indigo-400 uppercase tracking-wider mb-1",children:"DÃ­as PA Usados"}),e.jsx("p",{className:"text-lg font-black text-indigo-600 dark:text-indigo-400",children:s.diasPA})]}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-[9px] font-bold text-amber-400 uppercase tracking-wider mb-1",children:"DÃ­as FL Usados"}),e.jsx("p",{className:"text-lg font-black text-amber-600 dark:text-amber-400",children:s.diasFL})]}),e.jsxs("div",{className:`rounded-lg p-3 ${ee(s.saldo)}`,children:[e.jsx("p",{className:"text-[9px] font-bold opacity-70 uppercase tracking-wider mb-1",children:"Saldo PA"}),e.jsxs("p",{className:"text-lg font-black",children:[s.saldo.toFixed(1)," / ",s.diasHaber]})]}),e.jsxs("div",{className:`rounded-lg p-3 ${s.diasFL>0?ee(s.saldoFL):"bg-slate-50 dark:bg-slate-600"}`,children:[e.jsx("p",{className:"text-[9px] font-bold opacity-70 uppercase tracking-wider mb-1",children:"Saldo FL"}),e.jsx("p",{className:`text-lg font-black ${s.diasFL===0?"text-slate-400":""}`,children:s.diasFL>0?s.saldoFL.toFixed(1):"â€”"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-600 rounded-lg p-3",children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Uso por Tipo"}),e.jsxs("div",{className:"flex items-end gap-2 h-16",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"w-full bg-indigo-500 rounded-t transition-all",style:{height:`${Math.min(100,s.diasPA/Math.max(s.diasPA+s.diasFL,1)*100)}%`,minHeight:s.diasPA>0?"8px":"0"}}),e.jsx("span",{className:"text-[9px] font-bold text-indigo-600 dark:text-indigo-400 mt-1",children:"PA"}),e.jsx("span",{className:"text-[10px] font-black text-slate-600 dark:text-slate-300",children:s.diasPA})]}),e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"w-full bg-amber-500 rounded-t transition-all",style:{height:`${Math.min(100,s.diasFL/Math.max(s.diasPA+s.diasFL,1)*100)}%`,minHeight:s.diasFL>0?"8px":"0"}}),e.jsx("span",{className:"text-[9px] font-bold text-amber-600 dark:text-amber-400 mt-1",children:"FL"}),e.jsx("span",{className:"text-[10px] font-black text-slate-600 dark:text-slate-300",children:s.diasFL})]})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-600 rounded-lg p-3",children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider mb-2",children:"ProyecciÃ³n"}),(()=>{const a=ie(s),b=$e(s);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[10px] text-slate-500",children:"Uso mensual:"}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-700 dark:text-slate-200",children:[a.toFixed(1)," dÃ­as/mes"]})]}),b?e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-red-500",children:"Agotamiento:"}),e.jsxs("span",{className:"text-[10px] font-bold text-red-600 dark:text-red-400 flex items-center gap-1",children:[e.jsx(ae,{size:10}),b.toLocaleDateString("es-CL",{month:"short",year:"numeric"})]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[10px] text-emerald-500",children:"Estado:"}),e.jsx("span",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400",children:"Saldo estable"})]})]})})()]})]}),s.lastDecree&&e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-600 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:[e.jsx(he,{size:10})," Ãšltimo Decreto"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-black text-indigo-600 dark:text-indigo-400",children:s.lastDecree.acto}),e.jsxs("span",{className:"ml-2 text-[10px] text-slate-500 dark:text-slate-400",children:[s.lastDecree.solicitudType," Â· ",s.lastDecree.cantidadDias," dÃ­a(s)"]})]}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:ue(s.lastDecree.fechaInicio)})]})]}),s.decrees.length>1&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider mb-2",children:["Historial Reciente (",Math.min(s.decrees.length,5)," de ",s.decrees.length,")"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto custom-scrollbar",children:s.decrees.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 bg-slate-50 dark:bg-slate-600/50 rounded-lg text-[10px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[9px] font-bold ${a.solicitudType==="PA"?"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 dark:text-indigo-400":"bg-amber-100 dark:bg-amber-900/40 text-amber-600 dark:text-amber-400"}`,children:a.solicitudType}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:a.acto})]}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[e.jsxs("span",{children:[a.cantidadDias,"d"]}),e.jsx("span",{children:ue(a.fechaInicio)})]})]},a.id))})]}),s.decrees.length>0&&e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-600 pt-4",children:e.jsx(it,{records:s.decrees})}),u&&y&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 animate-in fade-in duration-200",children:[e.jsxs("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-400 mb-3 flex items-center gap-2",children:[e.jsx(be,{size:12})," Editar Funcionario"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("input",{placeholder:"Nombre completo",value:C.nombre,onChange:a=>R({...C,nombre:a.target.value}),onClick:a=>a.stopPropagation(),className:"flex-1 px-4 py-2 bg-white dark:bg-slate-700 border border-blue-200 dark:border-blue-700 rounded-xl outline-none focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 text-xs font-bold uppercase tracking-wide text-slate-700 dark:text-slate-200"}),e.jsx("input",{placeholder:"RUT",value:C.rut,onChange:a=>R({...C,rut:a.target.value}),onClick:a=>a.stopPropagation(),className:"flex-1 sm:max-w-[160px] px-4 py-2 bg-white dark:bg-slate-700 border border-blue-200 dark:border-blue-700 rounded-xl outline-none focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 text-xs font-bold tracking-wide text-slate-700 dark:text-slate-200 font-mono"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:a=>{a.stopPropagation(),ze(t.rut)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-[10px] font-black uppercase tracking-wider flex items-center gap-1",children:[e.jsx(We,{size:12})," Guardar"]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),Ie()},className:"px-4 py-2 bg-slate-200 dark:bg-slate-600 text-slate-600 dark:text-slate-300 rounded-lg text-[10px] font-black uppercase tracking-wider",children:e.jsx(xe,{size:12})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-100 dark:border-slate-600",children:[m&&e.jsxs("button",{onClick:a=>{a.stopPropagation(),m(t),k()},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl text-[10px] font-black uppercase tracking-wider transition-all",children:[e.jsx(re,{size:12})," Nuevo Decreto"]}),r&&e.jsxs("button",{onClick:a=>{a.stopPropagation(),r(t.nombre),k()},className:"flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-600 hover:bg-slate-200 dark:hover:bg-slate-500 text-slate-700 dark:text-slate-200 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all",children:[e.jsx(Qe,{size:12})," Ver Decretos"]}),y&&!u&&e.jsxs("button",{onClick:a=>{a.stopPropagation(),Me(t)},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all",children:[e.jsx(be,{size:12})," Editar"]}),n&&e.jsxs("button",{onClick:a=>{a.stopPropagation(),J(t.rut)},className:"flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all ml-auto",children:[e.jsx(et,{size:12})," Eliminar"]})]}),De===t.rut&&n&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 animate-in fade-in duration-200",children:[e.jsxs("p",{className:"text-xs font-bold text-red-700 dark:text-red-400 mb-3",children:["Â¿Eliminar a ",t.nombre,"? Esta acciÃ³n no se puede deshacer."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),Te(t.rut)},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-[10px] font-black uppercase tracking-wider",children:"SÃ­, eliminar"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),J(null)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-600 text-slate-600 dark:text-slate-300 rounded-lg text-[10px] font-black uppercase tracking-wider",children:"Cancelar"})]})]})]})]},t.rut)}),z.length===0&&e.jsxs("div",{className:"py-12 sm:py-16 text-center",children:[e.jsx(de,{className:"w-12 h-12 text-slate-200 dark:text-slate-700 mx-auto mb-4"}),e.jsx("p",{className:"text-[11px] sm:text-xs font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest",children:x?`Sin resultados para "${x}"`:"No hay funcionarios registrados"})]})]})}),e.jsx("div",{className:"p-4 sm:p-6 border-t border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest",children:["Mostrando ",ne.length," de ",z.length," funcionarios",z.length!==p.length&&` (${p.length} total)`]}),X>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>W(t=>Math.max(1,t-1)),disabled:I===1,className:"p-2 bg-white dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-100 dark:hover:bg-slate-600 transition-all",children:e.jsx(tt,{size:14})}),e.jsxs("span",{className:"text-[10px] font-black text-slate-600 dark:text-slate-300 px-3",children:[I," / ",X]}),e.jsx("button",{onClick:()=>W(t=>Math.min(X,t+1)),disabled:I===X,className:"p-2 bg-white dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-100 dark:hover:bg-slate-600 transition-all",children:e.jsx(fe,{size:14})})]}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-300 dark:text-slate-600 uppercase tracking-widest hidden sm:block",children:"Clic para expandir detalles"})]})})]}),Ce&&e.jsxs("div",{className:"absolute inset-0 z-[160] flex items-center justify-center p-4",onClick:()=>O(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/80 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white dark:bg-slate-800 rounded-2xl shadow-2xl overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black uppercase tracking-tight",children:"Importar Funcionarios"}),e.jsxs("p",{className:"text-[10px] font-bold opacity-70",children:[T.length," nuevos funcionarios detectados"]})]})]})}),e.jsx("div",{className:"p-4 max-h-64 overflow-y-auto custom-scrollbar",children:T.length===0?e.jsx("p",{className:"text-center text-slate-400 text-sm py-4",children:"No se encontraron nuevos funcionarios para importar"}):e.jsxs("div",{className:"space-y-2",children:[T.slice(0,20).map((t,i)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-white truncate flex-1",children:t.nombre}),e.jsx("span",{className:"text-[10px] font-mono text-slate-400 ml-2",children:t.rut})]},i)),T.length>20&&e.jsxs("p",{className:"text-center text-[10px] text-slate-400",children:["...y ",T.length-20," mÃ¡s"]})]})}),e.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{O(!1),Q([])},className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-xl text-[11px] font-black uppercase tracking-wider",children:"Cancelar"}),e.jsxs("button",{onClick:_e,disabled:T.length===0,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white rounded-xl text-[11px] font-black uppercase tracking-wider flex items-center gap-2",children:[e.jsx(ce,{size:14})," Importar Todos"]})]})]})]})]})};export{pt as default};
