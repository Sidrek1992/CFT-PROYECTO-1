import{r as b,j as e,C as O,X as _,f as q,p as W,b as X,H as G,F as K}from"./index-CfPzR3wC.js";import"./vendor--Eh9ivFN.js";import"./genai-IPx1z701.js";const ee=({isOpen:T,onClose:y,records:u})=>{const x=new Date,[D,f]=b.useState(new Date(x.getFullYear(),x.getMonth(),1)),[m,p]=b.useState(null),[j,A]=b.useState("todos"),[k,C]=b.useState(""),i=D.getFullYear(),n=D.getMonth(),F=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],M=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],P=new Date(i,n+1,0).getDate(),S=new Date(i,n,1).getDay(),L=b.useMemo(()=>{const t=new Set;return u.forEach(s=>{s.fechaInicio&&t.add(new Date(s.fechaInicio+"T12:00:00").getFullYear())}),t.add(x.getFullYear()),[...t].sort((s,a)=>a-s)},[u]),N=b.useMemo(()=>u.filter(t=>{if(j!=="todos"&&t.solicitudType!==j)return!1;if(k.trim()){const s=k.trim().toLowerCase();if(!t.funcionario.toLowerCase().includes(s)&&!t.rut.includes(s))return!1}return!0}),[u,j,k]),g=b.useMemo(()=>{const t={};return N.forEach(s=>{if(!s.fechaInicio)return;const a=new Date(s.fechaInicio+"T12:00:00");let d;if(s.solicitudType==="FL"&&s.fechaTermino){const r=new Date(s.fechaTermino+"T12:00:00");d=Math.round((r.getTime()-a.getTime())/(1e3*60*60*24))+1}else d=Math.max(Math.ceil(s.cantidadDias||1),1);for(let r=0;r<d;r++){const l=new Date(a);if(l.setDate(a.getDate()+r),l.getFullYear()===i&&l.getMonth()===n){const c=l.getDate();t[c]||(t[c]=[]),t[c].push({record:s,isStart:r===0,isEnd:r===d-1,isMid:r>0&&r<d-1,dayNumber:r+1})}}}),t},[N,i,n]),h=b.useMemo(()=>{let t=0,s=0,a=0,d=0;const r=new Set;return N.forEach(l=>{if(!l.fechaInicio)return;const c=new Date(l.fechaInicio+"T12:00:00");if(c.getFullYear()!==i||c.getMonth()!==n)return;const o=l.id||`${l.funcionario}-${l.fechaInicio}-${l.solicitudType}`;r.has(o)||(r.add(o),l.solicitudType==="PA"?(t+=l.cantidadDias,a++):(s+=l.cantidadDias,d++))}),{totalPA:t,totalFL:s,countPA:a,countFL:d}},[N,i,n]),$=()=>{f(new Date(i,n-1,1)),p(null)},E=()=>{f(new Date(i,n+1,1)),p(null)},Y=()=>{f(new Date(x.getFullYear(),x.getMonth(),1)),p(null)},I=t=>{const s=new Date(i,n,t);return s.getDay()===0||s.getDay()===6},w=t=>t===x.getDate()&&n===x.getMonth()&&i===x.getFullYear(),R=(t,s)=>t&&s?"rounded-md":t?"rounded-l-md":s?"rounded-r-md":"rounded-none";return T?e.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4",onClick:y,children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full max-w-5xl max-h-[92vh] bg-white dark:bg-slate-800 rounded-3xl shadow-2xl overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-5 sm:p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white/20 backdrop-blur p-2 rounded-xl",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base sm:text-lg font-black",children:"Calendario de Permisos"}),e.jsx("p",{className:"text-[11px] opacity-70 font-bold uppercase tracking-wider",children:"Vista mensual de decretos"})]})]}),e.jsx("button",{onClick:y,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e.jsx(_,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"px-4 sm:px-6 pt-4 pb-2 border-b border-slate-200 dark:border-slate-700 space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-700 rounded-lg p-0.5 gap-0.5",children:["todos","PA","FL"].map(t=>{const s={todos:"Todos",PA:"PA",FL:"FL"},a=j===t,d={todos:a?"bg-white dark:bg-slate-600 text-slate-800 dark:text-white shadow-sm":"",PA:a?"bg-indigo-600 text-white shadow-sm":"",FL:a?"bg-amber-500 text-white shadow-sm":""};return e.jsx("button",{type:"button",onClick:()=>{A(t),p(null)},className:`px-3 py-1 rounded-md text-[10px] font-black transition-all ${d[t]} ${a?"":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s[t]},t)})}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-1/2 -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Buscar empleado...",value:k,onChange:t=>{C(t.target.value),p(null)},className:"pl-7 pr-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-[11px] font-bold text-slate-700 dark:text-slate-200 placeholder-slate-400 outline-none focus:border-indigo-400 w-44"})]})]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 flex items-center gap-3 sm:gap-5 border-b border-slate-100 dark:border-slate-700 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"}),e.jsx("span",{className:"text-[11px] font-black text-slate-500 dark:text-slate-400",children:"PA:"}),e.jsxs("span",{className:"text-[11px] font-black text-indigo-600 dark:text-indigo-400",children:[h.countPA," decretos"]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",h.totalPA," días)"]})]}),e.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500"}),e.jsx("span",{className:"text-[11px] font-black text-slate-500 dark:text-slate-400",children:"FL:"}),e.jsxs("span",{className:"text-[11px] font-black text-amber-600 dark:text-amber-400",children:[h.countFL," decretos"]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",h.totalFL," días)"]})]}),e.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600"}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 dark:text-slate-500",children:["Total: ",h.totalPA+h.totalFL," días este mes"]})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-3 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:$,className:"p-1.5 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(W,{className:"w-4 h-4 text-slate-600 dark:text-slate-300"})}),e.jsx("button",{onClick:E,className:"p-1.5 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(X,{className:"w-4 h-4 text-slate-600 dark:text-slate-300"})})]}),e.jsxs("h3",{className:"text-base font-black text-slate-900 dark:text-white",children:[F[n]," ",i]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:i,onChange:t=>{f(new Date(Number(t.target.value),n,1)),p(null)},className:"bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 text-slate-700 dark:text-slate-200 text-[11px] font-black px-2 py-1 rounded-lg outline-none focus:border-indigo-400 cursor-pointer",children:L.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-1 px-2.5 py-1 bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 rounded-lg transition-colors",children:[e.jsx(G,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[10px] font-black",children:"Hoy"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-3",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1.5 sticky top-0 bg-white dark:bg-slate-800 pb-1 z-10",children:M.map((t,s)=>e.jsx("div",{className:`text-center py-1.5 text-[10px] font-black uppercase tracking-wider ${s===0||s===6?"text-red-400":"text-slate-400 dark:text-slate-500"}`,children:t},t))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:S}).map((t,s)=>e.jsx("div",{className:"h-24 bg-slate-50 dark:bg-slate-800/40 rounded-lg"},`empty-${s}`)),Array.from({length:P}).map((t,s)=>{const a=s+1,d=g[a]||[],r=d.length>0,l=I(a),c=m===a;return e.jsxs("div",{onClick:()=>p(r?c?null:a:null),className:["min-h-24 p-1.5 rounded-lg border transition-all",w(a)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":l?"border-transparent bg-red-50/40 dark:bg-red-900/8":"border-transparent bg-slate-50 dark:bg-slate-800/40",r?"cursor-pointer hover:border-indigo-300 dark:hover:border-indigo-700 hover:shadow-md":"",c?"ring-2 ring-indigo-500 border-indigo-400":""].join(" "),children:[e.jsx("div",{className:["text-[11px] font-black mb-0.5 px-0.5",w(a)?"text-indigo-600 dark:text-indigo-400":l?"text-red-400":"text-slate-600 dark:text-slate-300"].join(" "),children:w(a)?e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 bg-indigo-600 text-white rounded-full text-[10px]",children:a}):a}),r&&e.jsxs("div",{className:"space-y-0.5",children:[d.slice(0,3).map((o,H)=>{const v=o.record.solicitudType==="PA",J=v?"bg-indigo-100 dark:bg-indigo-900/50":"bg-amber-100 dark:bg-amber-900/50",z=v?"text-indigo-700 dark:text-indigo-300":"text-amber-700 dark:text-amber-300",B=R(o.isStart,o.isEnd),V=o.isMid?v?"border-l-2 border-l-indigo-400":"border-l-2 border-l-amber-400":"";return e.jsxs("div",{className:`${J} ${z} ${B} ${V} text-[9px] px-1.5 py-0.5 truncate font-bold flex items-center gap-0.5`,children:[o.isStart&&e.jsx("span",{className:"text-[7px] opacity-70",children:"●"}),o.isMid&&e.jsx("span",{className:"text-[7px] opacity-50",children:"─"}),o.isEnd&&!o.isStart&&e.jsx("span",{className:"text-[7px] opacity-70",children:"◆"}),e.jsx("span",{className:"truncate",children:o.record.funcionario.split(" ")[0]})]},H)}),d.length>3&&e.jsxs("div",{className:"text-[9px] text-slate-400 dark:text-slate-500 font-black px-1",children:["+",d.length-3," más"]})]})]},a)})]})]}),m&&g[m]&&e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/60",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 pt-3 pb-2",children:[e.jsxs("h4",{className:"text-sm font-black text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-indigo-500"}),M[new Date(i,n,m).getDay()]," ",m," de ",F[n]]}),e.jsxs("span",{className:"text-[10px] font-black text-slate-400 bg-slate-200 dark:bg-slate-700 px-2 py-0.5 rounded-full",children:[g[m].length," permiso",g[m].length!==1?"s":""]})]}),e.jsx("div",{className:"px-4 sm:px-6 pb-4 space-y-2 max-h-48 overflow-y-auto",children:g[m].map((t,s)=>{const a=t.record.solicitudType==="PA";return e.jsx("div",{className:"flex items-start justify-between bg-white dark:bg-slate-700 p-3 rounded-xl shadow-sm border border-slate-100 dark:border-slate-600",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"text-sm font-black text-slate-900 dark:text-white",children:t.record.funcionario}),e.jsx("span",{className:`text-[9px] font-black px-2 py-0.5 rounded-full ${a?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300":"bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300"}`,children:t.record.solicitudType}),!t.isStart&&e.jsxs("span",{className:"text-[9px] font-bold bg-slate-100 dark:bg-slate-600 text-slate-500 dark:text-slate-400 px-2 py-0.5 rounded-full",children:["Día ",t.dayNumber]})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-bold",children:t.record.acto}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"•"}),e.jsxs("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-bold",children:[t.record.cantidadDias," día",t.record.cantidadDias!==1?"s":""]}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"•"}),e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-bold",children:t.record.tipoJornada}),t.record.fechaTermino&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"•"}),e.jsxs("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-bold",children:["Hasta ",t.record.fechaTermino]})]})]})]})},s)})})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-2.5 border-t border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-indigo-100 dark:bg-indigo-900/50 border border-indigo-200 dark:border-indigo-800"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400",children:"Permiso Admin."})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-amber-100 dark:bg-amber-900/50 border border-amber-200 dark:border-amber-800"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400",children:"Feriado Legal"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-900/30"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400",children:"Fin de semana"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-600 flex items-center justify-center",children:e.jsx("span",{className:"text-[8px] text-white font-black",children:"1"})}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400",children:"Hoy"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[e.jsx("span",{className:"text-[9px] text-slate-400 dark:text-slate-500",children:"● inicio"}),e.jsx("span",{className:"text-[9px] text-slate-400 dark:text-slate-500",children:"─ medio"}),e.jsx("span",{className:"text-[9px] text-slate-400 dark:text-slate-500",children:"◆ fin"})]})]})]})]}):null};export{ee as default};
